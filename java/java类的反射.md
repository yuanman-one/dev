# 反射

- [反射](#反射)
  - [类的加载](#类的加载)
    - [加载](#加载)
    - [连接](#连接)
    - [初始化](#初始化)
  - [类的反射](#类的反射)
    - [反射](#反射-1)

## 类的加载

### 加载

- 就是指将 class 文件读入到内存中，并为之创建一个`class`对象任何类被使用时系统都会建立一个 `class`对象

### 连接

- 验证 是否有正确的内部结构，并和其他类协调一致
- 准备 负责为类的静态成员分配内存，并设置默认初始化值
- 解析 将类的二进制数据中的符号引用替换为直接引用

### 初始化

## 类的反射

### 反射

1. 反射是指在运行状态中，对于任意一个类，都能够知道这个类的所有属性和方法，对于
   任意一个对象，都能够调用它的任意一个方法和属性，这种动态获取信息以及动态调用
   对象的方法的功能称为 java 反射机制

2. 如何获取 class 对象

   - 利用 `Object` 中 `.getclass()`方法
   - `利用类名.class`
   - `Class.forName(String 类全称)`
     注意：类的全称=包名+类名

3. 检查对象内部结构
   检查类中声明的全部成员变量 字段=属性

   - `getDeclaredField(String name)`
     获取指定字段名称的成员变量
     返回一个 `Field` 对象,它反映此表示的类或接口的指定已声明字段类对象

   - `getDeclaredFields()`
     获取类中所有成员变量
     返回的数组 `Field`对象反映此表示的类或接口声明的所有字段类对象。

   - `getField(String name)`
     获取指定名称且用`public`所修饰的成员变量
     返回一个 Field 对象，它反映此表示的类或接口的指定公共成员字段 类对象。

   - `getFields()`
     获取所有 public 所修饰的成员变量
     返回包含一个数组 Field 对象反射由此表示的类或接口的所有可访问的公共字段 类对象。

4. 检查类中声明的全部成员变量

   - `getConstructor(类<?>... parameterTypes)`
     获取指定参数并且用 public 所修饰的构造方法  
     返回一个 Constructor 对象，该对象反映 Constructor 对象表示的类的指定的公共 类函数。

   - `getConstructors()`
     获取所有用 public 所修饰的构造方法
     返回包含一个数组 Constructor 对象反射由此表示的类的所有公共构造 类对象。

   - `getDeclaredConstructor(类<?>... parameterTypes)` 获取指定参数的构造方法
     返回一个 `Constructor` 对象，该对象反映 `Constructor` 对象表示的类或接口的指定类函数。

   - `getDeclaredConstructors()`
     获取所有参数的构造方法
     返回一个反映 Constructor 对象表示的类声明的所有 Constructor 对象的数组 类

   - `getMethod(String name, 类<?>... parameterTypes)`
     获取指定并且用 public 修饰的方法
     返回一个 方法对象，它反映此表示的类或接口的指定公共成员方法 类对象。

   - `getMethods()`
     获取所有用 public 修饰的自身方法包括继承过来的方法
     返回包含一个数组 方法对象反射由此表示的类或接口的所有公共方法 类对象，包括那些由类或接口和那些从超类和超接口继承的声明。

   - `getDeclaredMethod(String name, 类<?>... parameterTypes)`
     获取指定方法名称和参数名称的方法.
     返回一个 方法对象，它反映此表示的类或接口的指定声明的方法 类对象。

   - `getDeclaredMethods()`
     获取自身所拥有的所有方法，不包含继承的
     返回包含一个数组 方法对象反射的类或接口的所有声明的方法，通过此表示 类对象，包括公共，保护，默认（包）访问和私有方法，但不包括继承的方法。

5. 动态创建对象

   - 使用`Constructor`中提供的`newInstance(Object... initargs)`
   - 使用此`Constructor`对象表示的构造函数，使用指定的初始化参数来创建和
     初始化构造函数的声明类的新实例。
     注意：若不传参，则采用无参构造创建对象，若传参则采用有参构造创建对象

6. 动态调用方法

   - 使用`Method`类中提供的 `invoke(Object obj, Object... args)`
   - 在具有指定参数的方法对象上调用此方法对象表示的底层方法。
     注意：如果此方法使用 private 修饰的，若想调用，在 invoke 调用方法之前先通过
     setAccessible（true）打开权限

7. 变长参数
   - 变长参数本质就是一个数组参数
   - 使用`...`声明的参数称为变长参数如上方的`invoke(Object obj, Object... args)`
   - 在调用变长参数式可以传递任意多个参数
   - 在方法中，变长参数作为数组进行处理
   - 变长参数可以直接接收数组参数
   - 一个方法只能有一个变长参数，只能作为最后一个参数，
   - 若想接收多态参数可以使用 Object
